//Constructor de objeto Categorias del convenio, nomenclatura y respectivos salarios de seniorities al mes de febrero 2022
// class CategoriasConvenio{
//     constructor(a, b, c, d, e){
//         this.nombre = a;
//         this.codigo = b;
//         this.salarioJr = c;
//         this.salarioSmSr = d;
//         this.salarioSr = e;
//     }
// }

// //Reseteo del formulario
// document.getElementById('formMinuto').reset();

// //******************************************************************************************************************************************************/
// //Objetos categorías Administración IT, Soporte, Operaciones y Planificación
// const categoriaA1 = new CategoriasConvenio("Administrador de redes", "A.1", 83596.58, 91199.77, 98802.96);
// const categoriaA2 = new CategoriasConvenio("Administrador de Sistemas Operativos", "A.2", 86855.09, 94784.13, 102713.17);
// const categoriaA3 = new CategoriasConvenio("Administrador de Bases de Datos", "A.3", 89027.43, 97173.71, 105319.98);
// const categoriaA4 = new CategoriasConvenio("Administrador de Seguridad", "A.4", 89027.43, 97173.71, 105319.98);
// const categoriaA5 = new CategoriasConvenio("Auditor de Sistemas", "A.5", 85406.87, 93191.08, 100975.30);
// const categoriaA6 = new CategoriasConvenio("Soporte Técnico", "A.6", 67666.09, 73676.23, 79686.37);
// const categoriaA7 = new CategoriasConvenio("Operador / Data Entry", "A.7", 65493.75, 71286.66, 77079.57);
// const categoriaA8 = new CategoriasConvenio("Mesa de Ayuda", "A.8", 66941.98, 72879.71, 78817.44);
// const categoriaA9 = new CategoriasConvenio("Planificación", "A.9", 81677.68, 89088.98, 96500.28);
// const categoriaA10 = new CategoriasConvenio("Consultor en IT", "A.10", 92648.00, 101156.33, 109664.66);
// const categoriaA11 = new CategoriasConvenio("Especialista en IT", "A.11", 84320.70, 91996.30, 99671.90);
// const categoriaA12 = new CategoriasConvenio("Entrenador en IT", "A.12", 90837.72, 99165.02, 107492.32);
// const categoriaA13 = new CategoriasConvenio("Consultor Business Intelligence", "A.13", 107603.72, 117607.62, 127611.52);
// const categoriaA14 = new CategoriasConvenio("Community Manager", "A.14", 73514.70, 80109.70, 86704.70);
// const categoriaA15 = new CategoriasConvenio("Implementador", "A.15", 106935.31, 116872.37, 126809.43);
// const categoriaA16 = new CategoriasConvenio("Implementador ERP", "A.16", 89333.79, 97510.70, 105687.61);

// //Objetos categorías I+D, Análisis,  Arquitectura, Diseño, Programación, Testeo y Calidad
// const categoriaB1 = new CategoriasConvenio("Investigación y Desarrollo (I+D)", "B.1", 72734.89, 79251.90, 82222.05);
// const categoriaB2 = new CategoriasConvenio("Analista de Sistemas", "B.2", 87217.15, 95182.39, 103147.64);
// const categoriaB3 = new CategoriasConvenio("Arquitecto de Soluciones IT", "B.3", 96268.56, 105138.95, 114009.34);
// const categoriaB4 = new CategoriasConvenio("Diseñador de Software", "B.4", 92648.00, 101156.33, 109664.66);
// const categoriaB5 = new CategoriasConvenio("Diseñador Web y Multimedia", "B.5", 90837.72, 99165.02, 107492.32);
// const categoriaB6 = new CategoriasConvenio("Programador", "B.6", 87217.15, 95182.39, 103147.64);
// const categoriaB7 = new CategoriasConvenio("Analista QA - Tester", "B.7", 66941.98, 72879.71, 78817.44);
// const categoriaB8 = new CategoriasConvenio("Responsable de Calidad", "B.8", 94458.28, 103147.64, 111837);
// const categoriaB9 = new CategoriasConvenio("Ingeniero de Software", "B.9", 104595.87, 114298.98, 124002.10);
// const categoriaB10 = new CategoriasConvenio("Desarrollador Mobile", "B.10", 82761.07, 90280.71, 97800.34);
// const categoriaB11 = new CategoriasConvenio("Desarrollador Web", "B.11", 81201.44, 88565.11, 95928.79);
// const categoriaB12 = new CategoriasConvenio("Desarrollador de Juegos - Game Developer", "B.12", 84543.50, 92241.38, 99939.26);
// const categoriaB13 = new CategoriasConvenio("Diseñador de Juegos - Game Designer", "B.13", 89311.51, 97486.19, 105660.87);
// const categoriaB14 = new CategoriasConvenio("Diseñador de Niveles de Juegos - Level Designer", "B.14", 79976.02, 87217.15, 94458.28);
// const categoriaB15 = new CategoriasConvenio("Access Management", "B.15", 69949.84, 76188.35, 82426.86);
// const categoriaB16 = new CategoriasConvenio("Analista UX (Usabilidad)", "B.16", 79530.41, 86726.98, 93923.55);
// const categoriaB17 = new CategoriasConvenio("Productor Digital", "B.17", 81786.30, 89208.46, 96630.62);
// const categoriaB18 = new CategoriasConvenio("Analytics Enablement Analyst", "B.18", 81786.30, 89208.46, 96630.62);
// const categoriaB19 = new CategoriasConvenio("Analytics Analyst", "B.19", 81786.30, 89208.46, 96630.62);
// const categoriaB20 = new CategoriasConvenio("Analista Big Data (Data Scientist)", "B.20", 95025.08, 103771.12, 112517.16);

// //Comercial
// const categoriaC1 = new CategoriasConvenio("Preventa", "C.1", 68390.21, 74472.76, 80555.31);
// const categoriaC2 = new CategoriasConvenio("Ventas", "C.2", 76355.45, 83234.53, 90113.60);
// const categoriaC3 = new CategoriasConvenio("Marketing", "C.3", 82293.18, 89766.03, 97238.88);

// //Administrativo
// const categoriaD1 = new CategoriasConvenio("Administración, Finanzas y Contabilidad", "D.1", 73459.00, 80048.43, 86637.86);
// const categoriaD2 = new CategoriasConvenio("Recursos Humanos", "D.2", 76355.45, 83234.53, 90113.60);
// const categoriaD3 = new CategoriasConvenio("Relaciones Públicas, Comunicaciones y Asuntos Institucionales", "D.3", 83596.58, 91199.77, 98802.96);
// const categoriaD4 = new CategoriasConvenio("Servicios Generales y Mantenimiento", "D.4", 69114.32, 75269.28, 81424.24);
// const categoriaD5 = new CategoriasConvenio("Recepcionista", "D.5", 65493.75, 71286.66, 77079.57);

// //Personal Ejecutivo
// const categoriaE1 = new CategoriasConvenio("Analista de Proyectos", "E.1", 89027.43, 97173.71, 105319.98);
// const categoriaE2 = new CategoriasConvenio("Asistente", "E.2", 82148.36, 89606.72, 97065.09);
// const categoriaE3 = new CategoriasConvenio("Líder de Proyectos (PM)", "E.3", 106044.09, 115892.03, 125739.97);
// const categoriaE4 = new CategoriasConvenio("Analista de Negocios", "E.4", 117852.71, 128881.51, 139910.31);
// const categoriaE5 = new CategoriasConvenio("Administrador de Proyectos Marketing Digital ", "E.5", 81786.30, 89208.46, 96630.62);
// //******************************************************************************************************************************************************/

const arrayCategorias = []
//Petición a JSON local para traer info de categorías

fetch('./data/data.json')
  .then(response => response.json())
  .then(json => console.log(json))


    //Creación de array general con objetos de categorías
// arrayCategorias.push(categoriaA1, categoriaA2, categoriaA3, categoriaA4, categoriaA5, categoriaA6, categoriaA7, categoriaA8, categoriaA9, categoriaA10, categoriaA11, categoriaA12, categoriaA13, categoriaA14, categoriaA15, categoriaA16);
// arrayCategorias.push(categoriaB1, categoriaB2, categoriaB3, categoriaB4, categoriaB5, categoriaB6, categoriaB7, categoriaB8, categoriaB9, categoriaB10, categoriaB11, categoriaB12, categoriaB13, categoriaB14, categoriaB15, categoriaB16, categoriaB17, categoriaB18, categoriaB19, categoriaB20);
// arrayCategorias.push(categoriaC1, categoriaC2, categoriaC3);
// arrayCategorias.push(categoriaD1, categoriaD2, categoriaD3, categoriaD4, categoriaD5);
// arrayCategorias.push(categoriaE1, categoriaE2, categoriaE3, categoriaE4, categoriaE5);

//Actualización de salarios por paritaria 2021 - aumento de 5% en marzo
for (var i = 0; i < arrayCategorias.length; i++) 
{
    arrayCategorias[i].salarioJr += arrayCategorias[i].salarioJr *0.0454547

    arrayCategorias[i].salarioSmSr += arrayCategorias[i].salarioSmSr *0.0454547

    arrayCategorias[i].salarioSr += arrayCategorias[i].salarioSr *0.0454547

}

menuPrincipal = document.getElementById('seleccionArea');
menuPrincipal.addEventListener("change", areas);

let objetoUsuario = new Object();

// Función para crear las categorías según la primer elección del AREA de trabajo. Uso de eventos.
function areas(){
    switch (menuPrincipal.value)
    {
        case "Administración IT, Soporte, Operaciones y Planificación":
            objetoUsuario.area = menuPrincipal.value
            crearOpcion = document.getElementById("categorias");
            crearOpcion.innerHTML = '';
            //Crear opción deshabilitada para clarificar que se debe elegir una categoría
            const optionDefA = document.createElement("option");
            const nodoTextoDefA = document.createTextNode("Seleccionar categoría");
            optionDefA.selected = true
            optionDefA.disabled = true            
            optionDefA.appendChild(nodoTextoDefA);
            crearOpcion.appendChild(optionDefA);
            
            for (var i = 0; i < arrayCategorias.length; i++) 
            {
                if(arrayCategorias[i].codigo.startsWith("A"))
                {
                    //objetoUsuario.codigo = arrayCategorias[i].codigo
                    const option = document.createElement("option");
                    const nodoTexto = document.createTextNode(arrayCategorias[i].nombre);
                    option.appendChild(nodoTexto);
                    crearOpcion.appendChild(option);
                }
            }
            break;         

        case "Investigación y Desarrollo":
            objetoUsuario.area = menuPrincipal.value
            crearOpcion = document.getElementById("categorias");
            crearOpcion.innerHTML = '';
            //Crear opción deshabilitada para clarificar que se debe elegir una categoría
            const optionDefB = document.createElement("option");
            const nodoTextoDefB = document.createTextNode("Seleccionar categoría");
            optionDefB.selected = true
            optionDefB.disabled = true 
            optionDefB.appendChild(nodoTextoDefB);
            crearOpcion.appendChild(optionDefB);
            for (var i = 0; i < arrayCategorias.length; i++) 
            {
                if(arrayCategorias[i].codigo.startsWith("B"))
                {
                    //objetoUsuario.codigo = arrayCategorias[i].codigo
                    const option = document.createElement("option");
                    const nodoTexto = document.createTextNode(arrayCategorias[i].nombre);
                    option.appendChild(nodoTexto);
                    crearOpcion.appendChild(option);
                }
            }
            break;               

        case "Comercial":
            objetoUsuario.area = menuPrincipal.value
            crearOpcion = document.getElementById("categorias");
            crearOpcion.innerHTML = '';
            //Crear opción deshabilitada para clarificar que se debe elegir una categoría
            const optionDefC = document.createElement("option");
            const nodoTextoDefC = document.createTextNode("Seleccionar categoría");
            optionDefC.selected = true
            optionDefC.disabled = true 
            optionDefC.appendChild(nodoTextoDefC);
            crearOpcion.appendChild(optionDefC);
            for (var i = 0; i < arrayCategorias.length; i++) 
            {
                if(arrayCategorias[i].codigo.startsWith("C"))
                {
                    //objetoUsuario.codigo = arrayCategorias[i].codigo
                    const option = document.createElement("option");
                    const nodoTexto = document.createTextNode(arrayCategorias[i].nombre);
                    option.appendChild(nodoTexto);
                    crearOpcion.appendChild(option);
                }
            }
            break;               

        case "Administrativo":
            objetoUsuario.area = menuPrincipal.value
            crearOpcion = document.getElementById("categorias");
            crearOpcion.innerHTML = '';
            //Crear opción deshabilitada para clarificar que se debe elegir una categoría
            const optionDefD = document.createElement("option");
            const nodoTextoDefD = document.createTextNode("Seleccionar categoría");
            optionDefD.selected = true
            optionDefD.disabled = true 
            optionDefD.appendChild(nodoTextoDefD);
            crearOpcion.appendChild(optionDefD);
            for (var i = 0; i < arrayCategorias.length; i++) 
            {                
                if(arrayCategorias[i].codigo.startsWith("D"))
                {
                    //objetoUsuario.codigo = arrayCategorias[i].codigo
                    const option = document.createElement("option");
                    const nodoTexto = document.createTextNode(arrayCategorias[i].nombre);
                    option.appendChild(nodoTexto);                    
                    crearOpcion.appendChild(option);
                }
            }
            break;    

        case "Personal Ejecutivo":
            objetoUsuario.area = menuPrincipal.value
            crearOpcion = document.getElementById("categorias");
            crearOpcion.innerHTML = '';
            //Crear opción deshabilitada para clarificar que se debe elegir una categoría
            const optionDefE = document.createElement("option");
            const nodoTextoDefE = document.createTextNode("Seleccionar categoría");
            optionDefE.selected = true
            optionDefE.disabled = true 
            optionDefE.appendChild(nodoTextoDefE);
            crearOpcion.appendChild(optionDefE);
            for (var i = 0; i < arrayCategorias.length; i++) 
            {                
                if(arrayCategorias[i].codigo.startsWith("E"))
                {
                    //objetoUsuario.codigo = arrayCategorias[i].codigo
                    const option = document.createElement("option");
                    const nodoTexto = document.createTextNode(arrayCategorias[i].nombre);
                    option.appendChild(nodoTexto);
                    crearOpcion.appendChild(option);
                }
            }
            break;    
    }
}

// Obtener datos de los demás campos
let nombre = document.getElementById('nombre')
nombre.onchange = () => {objetoUsuario.nombre =nombre.value}

let empresa = document.getElementById('empresa')
empresa.onchange = () => {objetoUsuario.empresa = empresa.value}

let anioIngreso = document.getElementById('anioingreso')
anioIngreso.onchange = () => {objetoUsuario.ingreso = parseInt(anioIngreso.value)}

let mesIngreso = document.getElementById('mesingreso')
mesIngreso.oninput = () => {objetoUsuario.mes = parseInt(mesIngreso.value)}

let categoriaUsuario = document.getElementById('categorias')
categoriaUsuario.oninput = () => {
                                    objetoUsuario.categoria = categoriaUsuario.value
                                    for (let x in arrayCategorias) 
                                    {                
                                        if(arrayCategorias[x].nombre == objetoUsuario.categoria)
                                        {
                                            objetoUsuario.codigo = arrayCategorias[x].codigo
                                        }
                                    } 
                                }

let senioritiUsuario = document.getElementById('senioriti')
senioritiUsuario.oninput = () => {
                                    objetoUsuario.senioriti = senioritiUsuario.value
                                    for (let clave in arrayCategorias)
                                    {
                                        if(arrayCategorias[clave].codigo == objetoUsuario.codigo)
                                        {
                                            switch (objetoUsuario.senioriti)
                                            {
                                                case "Junior":
                                                    objetoUsuario.salarioConvenio = arrayCategorias[clave].salarioJr                                                    
                                                    break;
                                                
                                                case "Semi-Senior":
                                                    objetoUsuario.salarioConvenio = arrayCategorias[clave].salarioSmSr                                                    
                                                    break;

                                                case "Senior":
                                                    objetoUsuario.salarioConvenio = arrayCategorias[clave].salarioSr                                                    
                                                    break;
                                            }
                                        }
                                    }                                    
                                 }            

//Función para saber si es afiliado/a para calcular aporte
function radioAfiliadx(afi) {
    estadoAfiliacion = afi.value
    objetoUsuario.afiliacion = estadoAfiliacion;
} 

//Función para saber si aplica el plus por uso de idioma extranjero
function radioIdioma(src) {
    adicionalIdioma = src.value
    objetoUsuario.idioma = adicionalIdioma;
}    

//Función para saber si aplica el plus por Título
function radioTitulo(valor) {
    adicionalTitulo = valor.value
    objetoUsuario.titulo = adicionalTitulo;
}    

//Función para saber si aplica el adicional por función
function radioFuncion(val) {
    adicionalFuncion = val.value
    objetoUsuario.funcion = adicionalFuncion;
}   

//Posibilidad para el usuario de obtener los últimos datos usados desde el LocalStorage
function recuperarDatos(){
    const previoUsuario = JSON.parse(localStorage.getItem("SeleccionPrevia"));
    objetoUsuario = previoUsuario;
    renderRecibo()
}

const previoUsuario = JSON.parse(localStorage.getItem("SeleccionPrevia"));
if(previoUsuario)
{
    const swalWithBootstrapButtons = Swal.mixin({
        customClass: {
          confirmButton: 'btn btn-success',
          cancelButton: 'btn btn-danger'
        },
        buttonsStyling: false
      })
      
      swalWithBootstrapButtons.fire({
        title: 'Atencion',
        text: "Detectamos que ya utilizaste esta herramienta. Querés cargar automáticamente los datos que ya usaste?",
        icon: 'info',
        showCancelButton: true,
        confirmButtonText: 'Usar datos previos',
        cancelButtonText: 'No usar y eliminar',
        reverseButtons: false
      }).then((result) => {
        if (result.isConfirmed) {
            recuperarDatos()
        } else if (
          /* Read more about handling dismissals below */
          result.dismiss === Swal.DismissReason.cancel
        ) {
            localStorage.removeItem("SeleccionPrevia");
            swalWithBootstrapButtons.fire(
                'Borrado!',
                'Los datos previamente cargados fueron eliminados!',
                'success'
              )
        }
      })
}
else
{
    document.getElementById('botonRecupero').classList.add('reciboClaseNone');
}

//Funcion para mostrar los datos ingresados, los cálculos del salario y crear un PDF con el recibo
function renderRecibo()
{
    //Desestructuración de objeto con los datos del usuario
    const {area, nombre, empresa, ingreso, mes, categoria, codigo, senioriti, salarioConvenio, idioma, titulo, funcion, afiliacion} = objetoUsuario; 
    //Fecha actual para recibo
    let hoy = new Date(); 
    let fechaRecibo = hoy.getFullYear()+'-'+(hoy.getMonth()+1)+'-'+hoy.getDate();

    //Cálculo de años de antiguedad
    fechaActual = new Date().getFullYear();
    antiguedad = fechaActual - ingreso;

    //Cálculo plus por aniguedad según convenio
    plusAntiguedad = salarioConvenio * (antiguedad * 0.01);

    //Cálculo aporte sindical
    afiliacion == "SI" ? aporteSindicato = salarioConvenio * 0.02 : aporteSindicato = 0

    //Cálculo plus por presentimos
    plusPresentismo = salarioConvenio * 0.02;

    //Cálculo adicional Idioma Extranjero
    idioma == "SI" ? plusIdioma = salarioConvenio * 0.08 : plusIdioma = 0

    //Cálculo adicional título de grado
    if(titulo == "4")
    {
        plusTitulo = salarioConvenio * 0.08;
    }
    else if(titulo == "5")
    {
        plusTitulo = salarioConvenio * 0.12;
    }
    else
    {
        plusTitulo = 0;
    }

    //Cáculo adicional por función
    if(funcion == "Lider")
    {
        plusFuncion = salarioConvenio * 0.2;
    }
    else if(funcion == "Coordinador")
    {
        plusFuncion = salarioConvenio * 0.1;
    }
    else
    {
        plusFuncion = 0;
    }

    //Cálculo de aporte jubilatorio del empleado
    aporteJubilacion = salarioConvenio * 0.11;

    //Cálculo de aporte de INNSJPJ
    aporteInstituto = salarioConvenio * 0.03;

    //Cálculo de aporte a obra social
    aporteObraSocial = salarioConvenio * 0.03;

    //Cálculo de salario neto, en mano
    salarioNeto = salarioConvenio + plusAntiguedad + plusPresentismo + plusIdioma + plusTitulo - aporteJubilacion - aporteInstituto - aporteObraSocial -aporteSindicato;

    //Cálculo de días de vacaciones según ley
    if(antiguedad > 1 && antiguedad < 5)
    {
        vacaciones = 14;
    }
    else if (antiguedad >= 5 && antiguedad < 10)
    {
        vacaciones = 21;
    }
    else if (antiguedad >= 10 && antiguedad < 20)
    {
        vacaciones = 28;
    }
    else if (antiguedad >= 20)
    {
        vacaciones = 35;
    }
    // En caso que la antiguedad sea menor a 1 año hay que desdoblar el cálculo según la ley de contrato de trabajo indica en su artículo N°151
    else if(anioIngreso == fechaActual)
    {
        antiguedad = "El plus comienza a pagarse luego de tener como mínimo 1 año de antigûedad."
        compensacionVacaciones = 12 - mesIngreso
        if(compensacionVacaciones < 6)
        {
            vacaciones = compensacionVacaciones
        }
        else
        {
            vacaciones = 14;
        }
    }
    else
    {
        vacaciones = "No es posible calcularlas."
    }

    if(anioIngreso != fechaActual)
    {
        antiguedad = plusAntiguedad.toFixed(2) + ' por '  + antiguedad + ' años trabajados.'
    }

    console.log(vacaciones)

    //Guardado de objeto con los datos del usuario en el LocalStorage
    seleccionPrevia = JSON.stringify(objetoUsuario);
    localStorage.setItem("SeleccionPrevia", seleccionPrevia);

    //Uso de librería PDFmake para crear archivo de recibo de sueldo
    var docDefinition = {
        watermark: { text: 'UNIÓN INFORMÁTICA', color: 'grey', opacity: 0.1, bold: true, italics: false},
        content: [
            { 
                alignment: 'center',
                text: 'RECIBO DE SUELDO',
                style: 'header',
                fontSize: 18,
                bold: true,
                margin: [0, 10],
            },
            { 
                alignment: 'center',
                text: 'FECHA: ' + fechaRecibo,
                fontSize: 14,
                bold: true,
                margin: [0, 10],
            },
            {
                margin: [0, 0, 0, 10],
                layout: {
                    fillColor: function (rowIndex, node, columnIndex) {
                        return (rowIndex % 2 === 0) ? '#7DDF1A' : '#f5f5f5';
                    }
                },
                table: {
                    widths: ['100%'],
                    heights: [20,10],
                    body: [
                        [
                            { 
                                text: 'NOMBRE: ' + nombre,
                                fontSize: 12,
                                bold: true,
                            }
                        ],
                        [
                            { 
                                text: 'EMPLEADOR: ' + empresa,
                                fontSize: 12,
                                bold: true,
                            }
                        ],
                        [
                            { 
                                text: 'AREA: ' + area,
                                fontSize: 12,
                                bold: true,
                            }
                        ],
                        [
                            { 
                                text: 'CATEGORÍA: ' + categoria,
                                fontSize: 12,
                                bold: true
                            }
                        ],
                    ],
                }
            },
            {
                style: 'tableExample',
                layout: {
                    fillColor: function (rowIndex, node, columnIndex) {
                        return (rowIndex === 0) ? '#7DDF1A' : null;
                    }
                },
                table: {
                    widths: ['50%', '25%', '25%'],
                    //heights: [20,10,10,10,30,10,25],
                    headerRows: 1,
                    body: [
                        [
                            { 
                                text: 'Conceptos / Descripción',
                                alignment: 'center',
                                bold: true,
                                fontSize: 9
                            }, 
                            { 
                                text: 'Haberes',
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            },
                            {
                                text: 'Retenciones',
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            }
                        ],
                        [
                            {
                                text: 'Salario Bruto',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                                text: salarioConvenio,
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            },
                            { 
                            }
                        ],     
                        [
                            {
                                text: 'Plus por Antigüedad (1% por año trabajado)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                                text: plusAntiguedad.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            },
                            { 
                    
                            }
                            
                        ],     
                        [
                            {
                                text: 'Plus por Presentismo (2%)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                                text: plusPresentismo.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            },
                            { 
                    
                            }
                            
                        ],  
                        [
                            {
                                text: 'Adicional Idioma Extranjero (8%)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                                text: plusIdioma.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            },
                            { 
                    
                            }
                            
                        ],
                        [
                            {
                                text: 'Adicional Título de Grado (del 8% al 12%)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                                text: plusTitulo.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            },
                            { 
                    
                            }                            
                        ],   
                        [
                            {
                                text: 'Adicional por liderazgo o coordinación(del 10% al 20%)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                                text: plusFuncion.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            },
                            { 
                    
                            }
                            
                        ],   
                        [
                            {
                                text: 'Aporte Jubilatorio (11%)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                    
                            },
                            { 
                                text: aporteJubilacion.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            }                        
                            
                        ],
                        [
                            {
                                text: 'Aporte INSSJP (3%)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                    
                            },
                            { 
                                text: aporteInstituto.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            }                        
                            
                        ],
                        [
                            {
                                text: 'Obra Social (3%)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                    
                            },
                            { 
                                text: aporteObraSocial.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            }                        
                            
                        ],
                        [
                            {
                                text: 'Afiliación Unión Informática (2%)',
                                fontSize: 9,
                                bold: true
                            }, 
                            { 
                    
                            },
                            { 
                                text: aporteSindicato.toFixed(2),
                                alignment: 'center',
                                fontSize: 9,
                                bold: true
                            }                        
                            
                        ],                        
                    ]
                }
            },
            {
                style: 'tableExample',
                layout: {
                    fillColor: function (rowIndex, node, columnIndex) {
                        return (rowIndex === 0) ? '#7DDF1A' : null;
                    }
                },
                table: {
                    widths: ['50%', '25%', '25%'],
                    //heights: [20,10,10,10,30,10,25],
                    headerRows: 1,
                    body: [
                        [
                            { 
                                text: 'SALARIO NETO',
                                bold: true,
                                colSpan: 2,
                                fontSize: 12
                            }, 
                            { 
                               
                            },
                            {
                                text: 'Salario a cobrar: ' + salarioNeto.toFixed(2),
                                alignment: 'right',
                                fontSize: 12,
                                bold: true                                
                            }
                        ],                                                
                    ]
                }
            }
            
        ],
    };
    pdfMake.createPdf(docDefinition).open();
}

function calcularVacacioes()
{
    //Desestructuración de objeto con los datos del usuario
    const {area, nombre, empresa, ingreso, mes, categoria, codigo, senioriti, salarioConvenio, idioma, titulo, funcion} = objetoUsuario; 
    //Fecha actual para recibo
    let hoy = new Date(); 
    let fechaRecibo = hoy.getFullYear()+'-'+(hoy.getMonth()+1)+'-'+hoy.getDate();

    //Cálculo de años de antiguedad
    fechaActual = new Date().getFullYear();
    antiguedad = fechaActual - ingreso;

    //Cálculo de días de vacaciones según ley
    if(antiguedad > 1 && antiguedad < 5)
    {
        vacaciones = 14;
    }
    else if (antiguedad >= 5 && antiguedad < 10)
    {
        vacaciones = 21;
    }
    else if (antiguedad >= 10 && antiguedad < 20)
    {
        vacaciones = 28;
    }
    else if (antiguedad >= 20)
    {
        vacaciones = 35;
    }
    // En caso que la antiguedad sea menor a 1 año hay que desdoblar el cálculo según la ley de contrato de trabajo indica en su artículo N°151
    else if(antiguedad == 0)
    {
        if(mes < 6)
        {
            //Obtención del current mes sumando 1 para calcular a partir de 1 y no de 0
            compensacion = new Date().getMonth() + 1;
            vacaciones = compensacion - mes
        }
        else
        {
            vacaciones = 14;
        }
    }
    else
    {
        vacaciones = "No es posible calcularlas."
    }
    Swal.fire(
        'Te corresponden ' + vacaciones + ' días de vacaciones por ley',
        'Si estás afiliado/a a la Unión Informática tenés 1 semana extra libre por Convenio.',
        'success'
      )
}

//Funcion para mostrar el recibo en el HTML
function renderReciboHTML()
{
    //Desestructuración de objeto con los datos del usuario
    const {area, nombre, empresa, ingreso, mes, categoria, codigo, senioriti, salarioConvenio, idioma, titulo, funcion, afiliacion} = objetoUsuario; 
    //Fecha actual para recibo
    let hoy = new Date(); 
    let fechaRecibo = hoy.getFullYear()+'-'+(hoy.getMonth()+1)+'-'+hoy.getDate();

    //Cálculo de años de antiguedad
    fechaActual = new Date().getFullYear();
    antiguedad = fechaActual - ingreso;

    //Cálculo plus por aniguedad según convenio
    plusAntiguedad = salarioConvenio * (antiguedad * 0.01)
    pa = plusAntiguedad.toFixed(2)

    //Cálculo aporte sindical
    afiliacion == "SI" ? aporteSindicato = salarioConvenio * 0.02 : aporteSindicato = 0
    as = aporteSindicato.toFixed(2)

    //Cálculo plus por presentimos
    plusPresentismo = salarioConvenio * 0.02;
    pp = plusPresentismo.toFixed(2)

    //Cálculo adicional Idioma Extranjero
    idioma == "SI" ? plusIdioma = salarioConvenio * 0.08 : plusIdioma = 0
    pi = plusIdioma.toFixed(2)

    //Cálculo adicional título de grado
    if(titulo == "4")
    {
        plusTitulo = salarioConvenio * 0.08;
    }
    else if(titulo == "5")
    {
        plusTitulo = salarioConvenio * 0.12;
    }
    else
    {
        plusTitulo = 0;
    }
    pt = plusTitulo.toFixed(2)

    //Cáculo adicional por función
    if(funcion == "Lider")
    {
        plusFuncion = salarioConvenio * 0.2;
    }
    else if(funcion == "Coordinador")
    {
        plusFuncion = salarioConvenio * 0.1;
    }
    else
    {
        plusFuncion = 0;
    }
    pf = plusFuncion.toFixed(2)

    //Cálculo de aporte jubilatorio del empleado
    aporteJubilacion = salarioConvenio * 0.11;
    aj = aporteJubilacion.toFixed(2)

    //Cálculo de aporte de INNSJPJ
    aporteInstituto = salarioConvenio * 0.03;
    ai = aporteInstituto.toFixed(2)

    //Cálculo de aporte a obra social
    aporteObraSocial = salarioConvenio * 0.03;
    aos = aporteObraSocial.toFixed(2)

    sb = salarioConvenio.toFixed(2)

    //Cálculo de salario neto, en mano
    salarioNeto = salarioConvenio + plusAntiguedad + plusPresentismo + plusIdioma + plusTitulo - aporteJubilacion - aporteInstituto - aporteObraSocial -aporteSindicato;
    sn = salarioNeto.toFixed(2)

    //Cálculo de días de vacaciones según ley
    if(antiguedad > 1 && antiguedad < 5)
    {
        vacaciones = 14;
    }
    else if (antiguedad >= 5 && antiguedad < 10)
    {
        vacaciones = 21;
    }
    else if (antiguedad >= 10 && antiguedad < 20)
    {
        vacaciones = 28;
    }
    else if (antiguedad >= 20)
    {
        vacaciones = 35;
    }
    // En caso que la antiguedad sea menor a 1 año hay que desdoblar el cálculo según la ley de contrato de trabajo indica en su artículo N°151
    else if(anioIngreso == fechaActual)
    {
        antiguedad = "El plus comienza a pagarse luego de tener como mínimo 1 año de antigûedad."
        compensacionVacaciones = 12 - mesIngreso
        if(compensacionVacaciones < 6)
        {
            vacaciones = compensacionVacaciones
        }
        else
        {
            vacaciones = 14;
        }
    }
    else
    {
        vacaciones = "No es posible calcularlas."
    }

    if(anioIngreso != fechaActual)
    {
        antiguedad = plusAntiguedad.toFixed(2) + ' por '  + antiguedad + ' años trabajados.'
    }

    console.log(vacaciones)

    //Guardado de objeto con los datos del usuario en el LocalStorage
    seleccionPrevia = JSON.stringify(objetoUsuario);
    localStorage.setItem("SeleccionPrevia", seleccionPrevia);

    document.getElementById('reciboHtml').classList.add('reciboClaseDisplay');
    //document.getElementById('reciboHtml').classList.add('reciboDatos');
    let recibo = document.getElementById('reciboHtml')
    recibo.innerHTML =`
    <div class="container reciboDatos">
    <div class="row align-items-start">
        <div class="col">
        <strong>Empleado/a:</strong> ${nombre}
        </div>
        <div class="col">
        <strong>Empresa:</strong> ${empresa}
        </div>
        <div class="col">
        <strong>Fecha:</strong> ${fechaRecibo}
        </div>
    </div>
    <div class="row align-items-center">
        <div class="col">
        <strong>Area:</strong> ${area}
        </div>
        <div class="col">
        <strong>Categoría:</strong> ${categoria}
        </div>
        <div class="col">
        <strong>Seniority:</strong> ${senioriti}
        </div>
    </div>
    <div class="row align-items-center">
        <div class="col offset-md-8">
            <strong>Sueldo Bruto: </strong> ${sb}
        </div>
    </div>
    </div>
    <table class="table table-success table-striped">
        <thead>
        <tr>
        <th scope="col">Conceptos / Descripción</th>
        <th scope="col">Haberes</th>
        <th scope="col">Retenciones</th>
        </tr>
        </thead>
        <tbody>
            <tr>
                <th scope="row">Salario Bruto</th>
                <td>${sb}</td>
                <td></td>
            </tr>
            <tr>
                <th scope="row">Plus por Antigüedad (1% por año trabajado)</th>
                <td>${pa}</td>
                <td></td>
            </tr>
            <tr>
            <th scope="row">Plus por Presentismo (2%)</th>
            <td>${pp}</td>
            <td></td>
            </tr>
            <tr>
            <th scope="row">Adicional Idioma Extranjero (8%)</th>
            <td>${pi}</td>
            <td></td>
            </tr>
            <tr>
            <th scope="row">Adicional Título de Grado (del 8% al 12%)</th>
            <td>${pt}</td>
            <td></td>
            </tr>
            <tr>
            <th scope="row">Adicional por liderazgo o coordinación(del 10% al 20%)</th>
            <td>${pf}</td>
            <td></td>
            </tr>
            <tr>
            <th scope="row">Afiliación Unión Informática (2%)</th>
            <td></td>
            <td>${as}</td>
            </tr>
            <tr>
            <th scope="row">Aporte Jubilatorio (11%)</th>
            <td></td>
            <td>${aj}</td>
            </tr>
            <tr>
            <th scope="row">Aporte INSSJP (3%)</th>
            <td></td>
            <td>${ai}</td>
            </tr>
            <tr>
            <th scope="row">Obra Social (3%)</th>
            <td></td>
            <td>${aos}</td>
            </tr>
            <tr>
            <th scope="row"><h5><strong>SALARIO NETO</strong></h5></th>
            <td></td>
            <td><h4>${sn}</h4></td>
            </tr>
        </tbody>
    </table>
    
    <div class="card">
    <h5 class="card-header">Información</h5>
    <div class="card-body">
        <h5 class="card-title">Paritaria Unión Informática 2020/2021 = 50% de incremento salarial</h5>
        <p class="card-text">Reintegro por Guardería: $8.500 - Tope salarial $100.000</p>
        <p>Salario Mínimo: $65.493,75 | Costo por Km: $33</p>
        <p>Aporte Sindical: 2% sobre el salario bruto</p>
        <p>#SemanaUI: 7 días extra de licencia para afiliados/as.</p>
        <a href="https://unioninformatica.org/contacto/" class="btn btn-outline-dark">Afiliarse</a>
    </div>
    </div>`
}
